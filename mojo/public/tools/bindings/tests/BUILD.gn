import("//mojo/public/tools/bindings/mojom.gni")
import("//tools/typescript/webui_ts_library.gni")

mojom("test_mojom") {
  sources = [ "test.test-mojom" ]
  webui_module_path = "chrome://resources/mojo/public/tools/bindings/tests"
  testonly = true

  ts_typemaps = [
    {
      types = [
        {
          mojom = "bindings.tests.mojom.SimpleStruct"
          ts = "string"
          converter = "SimpleStructConverter"
          import = "test_converter.js"
        },
      ]
    },
  ]
}

copy("copy_converter") {
  sources = [ "test_converter.ts" ]
  outputs = [ "${target_gen_dir}/test_converter.ts" ]
}

# TODO(ffred): Remove this once we have actual dependents on ts typemapping.
webui_ts_library("build_ts") {
  root_dir = target_gen_dir

  in_files = [
    "test_converter.ts",
    "test.test-mojom-webui.ts",
    "test.test-mojom-converters.ts",
  ]

  deps = [ "//ui/webui/resources/mojo:build_ts" ]

  extra_deps = [
    ":copy_converter",
    ":test_mojom_ts__generator",
  ]
}
